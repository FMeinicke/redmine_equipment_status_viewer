<% html_title t(:lable_chek, :asset => @equipment_asset.name) %>
<% content_for :page_id, "assetCheckIn" %>

<% content_for :page_header do %>
  <h1><%= t :lable_chek_plural %></h1>
  <a href="<%= edit_equipment_asset_path(@equipment_asset) %>" data-icon="gear" class="ui-btn-right"><%= t :edit %></a>
<% end %>

<h3><%= t :check_in_for, :asset => @equipment_asset.name %></h3>
<%= form_for([@equipment_asset, @asset_check_in]) do |f| %>
  <div data-role="collapsible">
    <h3><%= t :details %></h3>
    <div class="box">
      <table>
        <tbody>
          <tr>
            <th scope="row"><%= t :field_asset_type %>:</th>
            <td><%= @equipment_asset.asset_type %></td>
          </tr>
          <tr>
            <th scope="row"><%= t :field_serial_number %>:</th>
            <td><%= @equipment_asset.serial_number %></td>
          </tr>
          <tr>
            <th scope="row"><%= t :field_location %>:</th>
            <td><%= @equipment_asset.location %></td>
          </tr>
        </tbody>
        <% if @equipment_asset.oos? %>
          <tfoot>
            <tr>
              <td colspan="2" class="oos">
                <%= t :asset_is_out_of_service, :asset => @equipment_asset.name %>
              </td>
            </tr>
          </tfoot>
        <% end %>
      </table>
      <% unless @equipment_asset.resource_url.blank? %>
        <a href="<%= @equipment_asset.resource_url %>" target="_blank"
          data-role="button" data-mini="true" data-icon="arrow-r"
          data-iconpos="right"><%= t :view_additional_resource %></a>
      <% end %>
      <% unless @equipment_asset.comment.blank? %>
        <div>
          <h4><%= t :field_comment %></h4>
          <p><%= @equipment_asset.comment %></p>
        </div>
      <% end %>
    </div>
  </div>
  <%= error_messages_for 'equipment_asset', 'asset_check_in' %>
  <div data-role="fieldcontain" class="ui-hide-label">
    <fieldset>
      <%= f.label :person %>
      <%= f.text_field :person, :placeholder => t(:field_person) %>
    </fieldset>
  </div>
  <div data-role="fieldcontain" class="ui-hide-label">
    <fieldset>
      <%= f.label :location %>
      <%= f.search_field :location, :placeholder => t(:field_location) %>
      <ul id="loclist" data-role="listview" data-inset="true"></ul>
    </fieldset>
  </div>
  <div data-role="fieldcontain">
    <fieldset>
      <%= f.label :equipment_asset_oos, t(:field_oos) %>
      <%= f.select :equipment_asset_oos, {"No" => false, "Yes" => true}, {}, {"data-role" => "slider"} %>
    </fieldset>
  </div>
  <div data-role="fieldcontain">
    <fieldset>
      <%= f.submit t(:lable_chek) %>
    </fieldset>
  </div>
<% end %>
<script type="text/javascript">
  $("#assetCheckIn").bind("pageshow", function(e) {
    $("#asset_check_in_location").autocomplete({
      source: <%= @locations.to_json.html_safe %>,
      target: $("#loclist"),
      minLength: 1,
      callback: function(e) {
        var $a = $(e.currentTarget); // access the selected item
        $('#asset_check_in_location').val($a.text()); // place the value of the selection into the search box
        $("#asset_check_in_location").autocomplete('clear'); // clear the listview
      }
    });
  });
</script>
